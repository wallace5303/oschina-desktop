(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-07139c88"],{"38db":function(t,e,n){},"6b68":function(t,e,n){"use strict";n("38db")},b64b:function(t,e,n){"use strict";n.r(e);var o=function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"app-auth"}},[e("div",{staticClass:"block-1"},[t.loading?e("span",[t._v(t._s(t.loginText))]):e("a",{attrs:{href:t.authUrl,target:"_blank"},on:{click:t.getToken}},[e("a-button",{attrs:{type:"primary"}},[t._v(" 授权登录 ")])],1)])])},a=[],i=n("cff8"),r=n.n(i),s=n("2ef0"),c=n.n(s),l=n("a358"),h={data(){return{loading:!1,authUrl:"",loginText:"正在登陆......"}},mounted(){this.init()},methods:{init(){this.checkToken()?this.redectHome():this.$ipcInvoke(l["a"].oschina.authInfo,{}).then(t=>{console.log("authInfo:",t),this.authUrl=t.authUrl})},checkToken(){const t=r.a.get("token_info");if(console.log("token_info:",t),c.a.isEmpty(t))return!1;let e=(new Date).valueOf(),n=1e3*t.expires_time;return!(e>n)},delToken(){r.a.remove("token_info")},getToken(){if(c.a.isEmpty(this.authUrl))return void this.$message.error("无效的授权链接");const t=this;let e,n=1;e=setInterval((function(){console.log("retry number:",n),t.$ipcInvoke(l["a"].oschina.getAuthToken,{}).then(n=>{if(console.log("getAuthToken res:",n),0==n.code){clearInterval(e);const o=n.data.token_info;return r.a.set("token_info",o),void t.redectHome()}}),n++}),1e3),setTimeout((function(){this.$message.error("服务器超时异常"),clearInterval(e)}),15e3)},redectHome(){this.loading=!0,this.$ipcInvoke(l["a"].common.changeWindowSize,{}).then(t=>{this.$router.push({name:"Information",params:{}})})}}},u=h,f=(n("6b68"),n("2877")),d=Object(f["a"])(u,o,a,!1,null,"c6a9a62a",null);e["default"]=d.exports}}]);
//# sourceMappingURL=chunk-07139c88.f9ef96e2.js.map